<div class="mt-6">
  <h2 class="text-lg font-medium mb-3">Add member</h2>

  <%# Use remote (Turbo) form submission and filter out existing members for the specific resource %>
  <% available_members = begin
    case scope.to_s
    when "group_member"
      Group.find(id_value).member_ids
    when "team_member"
      Team.find(id_value).member_ids
    else
      []
    end
  rescue
    []
  end %>

  <% members = Member.where.not(id: available_members).order(:last_name, :first_name) %>

  <%= form_with url: create_path, scope: scope, local: false do |f| %>
    <%= f.hidden_field id_field, value: id_value %>

    <div class="flex items-start space-x-3">
      <div class="flex-1">
        <%= f.label :member_id, "Member", class: "form-label" %>
        <%= f.select :member_id, options_from_collection_for_select(members, :id, :full_name), { include_blank: "Select a member" }, class: "form-input" %>
      </div>

      <div class="pt-6">
        <%= f.submit "Add member", class: "btn-primary" %>
      </div>
    </div>
  <% end %>
</div>
